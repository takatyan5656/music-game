import"./modulepreload-polyfill-B5Qt9EMX.js";const g=document.getElementById("btn1"),y=document.getElementById("btn2"),p=document.getElementById("btn3"),h=document.getElementById("btn4"),k=document.getElementById("lane1"),w=document.getElementById("lane2"),B=document.getElementById("lane3"),C=document.getElementById("lane4"),f=[k,w,B,C],L=154,x=145,S=170,_=204;let m=0,l=0;const u=document.getElementById("comb"),E=new Audio("/music-game/se/se1.mp3"),v=[];document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("countdown"),t=document.getElementById("start-message");function s(o){return new URLSearchParams(window.location.search).get(o)}const n=s("song");switch(n){case"senbon.mp3":m=L;break;case"syaruru.mp3":m=x;break;case"bisyouzyo.mp3":m=S;break;case"over.mp3":m=_;break;default:throw new Error("No song selected")}const c=new Audio("/music-game/music/"+n);let r=3;const i=setInterval(()=>{r--,e.textContent=String(r),r<=0&&(clearInterval(i),e.style.display="none",t.style.display="block",setTimeout(()=>{t.style.display="none",c.currentTime=1,c.playbackRate=1,c.play(),v.push(setInterval(()=>{let o=Math.floor(Math.random()*f.length);R(f[o])},6e4/m*2)),c.addEventListener("ended",b)},1e3))},1e3);function b(){v.forEach(o=>clearInterval(o))}});if(!g||!y||!p||!h)throw new Error("ボタンの要素が存在しない");const M=[];function R(e){M.push({lane:Math.floor(Math.random()*4),height:0});const t=document.createElement("div");t.classList.add("note"),e.appendChild(t);let s=0;const n=setInterval(()=>{s+=1,t.style.top=s+"px",s>window.innerHeight&&(clearInterval(n),t.parentElement===e&&e.removeChild(t))},2);t.dataset.intervalId=String(n)}function D(e,t){const s=(e.width+e.left)/2,n=(e.height+e.top)/2,c=(t.width+t.left)/2,r=(t.height+t.top)/2;return P(s,n,c,r)}function P(e,t,s,n){return Math.sqrt((s-e)**2+(n-t)**2)}function d(e){const t=document.querySelectorAll(".note"),s=e.getBoundingClientRect();let n=!1;return E.currentTime=0,E.play(),t.forEach(c=>{const r=c.getBoundingClientRect();let i=D(r,s);const b="images-container"+e.id.replace("btn",""),o=document.getElementById(b),a=document.createElement("img");if(a.style.width="50px",a.style.height="50px",a.alt="当たり判定",console.log(i),i<11){const I=c.dataset.intervalId;c.remove(),clearInterval(Number(I)),console.log(e.id),i<=2?(a.src="/music-game/images/perfect.png",l++,u.textContent=l+" combo!"):i<=4?(a.src="/music-game/images/great.png",l++,u.textContent=l+" combo!"):i<=7?(a.src="/music-game/images/good.png",l=0,u.textContent=l+" combo!"):i<=10&&(a.src="/music-game/images/bad.png",l=0,u.textContent=l+" combo!"),o==null||o.appendChild(a),setTimeout(()=>o==null?void 0:o.removeChild(a),500),n=!0}}),n}g.addEventListener("click",()=>d(g));y.addEventListener("click",()=>d(y));p.addEventListener("click",()=>d(p));h.addEventListener("click",()=>d(h));const T=e=>{e.key==="d"||e.key==="1"?d(g):e.key==="f"||e.key==="2"?d(y):e.key==="j"||e.key==="3"?d(p):(e.key==="k"||e.key==="4")&&d(h)};window.addEventListener("keydown",T);
